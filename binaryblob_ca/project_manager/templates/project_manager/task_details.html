<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <link rel="stylesheet" type="text/css" href="{% static 'project_manager/form_style.css' %}">
    <meta charset="UTF-8">
    <title>Edit task</title>
    <style>
         pre {
            overflow-x: auto;
            white-space: pre-wrap;
            white-space: -moz-pre-wrap;
            white-space: -pre-wrap;
            white-space: -o-pre-wrap;
            word-wrap: break-word;
         }
     </style>
</head>
<body>
    <div class="container">
    <form id="contact" class="details_form" action="{% url 'project_manager:edit_task_submit' ipk %}" method="post">
        {% csrf_token %}

        {% if perms.project_manager.update_taskmodel %}
        {% if disabled != "" %}
        <a href="{% url 'project_manager:edit_task' ipk %}">Enable editing</a><br/>
        {% else %}
        <a href="{% url 'project_manager:details' ipk %}">Disable editing</a><br/>
        {% endif %}
        {% endif %}

        {% if messages %}
        {% for message in messages %}
        <div class="message">{{ message }}</div>
        {% endfor %}
        {% endif %}

        <fieldset>
            <label class="one-line" for="task_priority">Priority: (Safe to leave at default)</label>
            <input {{ disabled }} class="one-line" type="number" name="task_priority" value="{{task.priority}}">
        </fieldset>
        <fieldset>
            <label for="task_title">Task title: </label>
            <input {{ disabled }} class="one-line" type="text" maxlength="80" name="task_title" value="{{task.title}}">
        </fieldset>
        <fieldset>
            <label for="task_desc">Task description: </label><br/>
            <textarea {{ disabled }} style="width:600px;height:300px;" name="task_desc">{{task.desc}}</textarea>
        </fieldset>
        <fieldset>
            <label for="task_scheduled_start">Scheduled to start on: ({{task.scheduled_start}})</label>
            <input {{ disabled }} class="one-line" type="datetime-local" name="task_scheduled_start" value="{{task.scheduled_start|date:'Y-m-d\TH:i'}}">
        </fieldset>

        {% if task.started_on %}
        <fieldset class="highlight">
            <label for="task_started_on">This task was started on: ({{task.started_on}})</label>
            <input {{ disabled }} class="one-line" type="datetime-local" name="task_started_on" value="{{task.started_on|date:'Y-m-d\TH:i'}}">
        </fieldset>
        {% else %}
        <fieldset>
            <label for="task_started_on">Actual start time:</label>
            <input {{ disabled }} class="one-line" type="datetime-local" name="task_started_on" value="{{task.started_on|date:'Y-m-d\TH:i'}}">
        </fieldset>
        {% endif %}

        <fieldset>
            <label for="task_deadline">With a deadline on: ({{task.deadline}})</label>
            <input {{ disabled }} style="float:right;clear:both;" type="datetime-local" name="task_deadline" value="{{task.deadline|date:'Y-m-d\TH:i'}}">
        </fieldset>

        {% if task.completed_on %}
        <fieldset class="highlight">
            <label for="task_completed_on">This task was completed on: ({{task.completed_on}})</label>
            <input {{ disabled }} class="one-line" type="datetime-local" name="task_completed_on" value="{{task.completed_on|date:'Y-m-d\TH:i'}}">
        </fieldset>
        {% else %}
        <fieldset>
            <label for="task_completed_on">Completion date:</label>
            <input {{ disabled }} class="one-line" type="datetime-local" name="task_completed_on" value="{{task.completed_on|date:'Y-m-d\TH:i'}}">
        </fieldset>
        {% endif %}

        {% if disabled == "" %}
        <input type="submit" value="Submit edit">
        {% endif %}
        <a class="one-line" href="{% url 'project_manager:index' %}">Return to index</a>
    </form>
    </div>
    <div class="container" style="background: #f9f9f9;">
        {% if notes %}
        {% for note in notes %}
        <p>On {{note.date}}:
        <pre>{{ note.text }}</pre>
        </p>
        {% endfor %}
        {% endif %}
    </p>
    <div class="container">
        <form class="details_form" action="{% url 'project_manager:add_note' ipk %}" method="post">
            {% csrf_token %}
            <fieldset>
                <label for="task_note">Add a note here:</label>
                <textarea style="width:600px;height:300px;" name="task_note"></textarea>
            </fieldset>
            <input type="submit" value="Add note">
        </form>
    </div>
</body>
</html>